// app.js
let isRecording = false;
let recordedChunks = [];
let mediaRecorder;

const startRecordBtn = document.getElementById('startRecordBtn');
const stopRecordBtn = document.getElementById('stopRecordBtn');
const videoPlayer = document.getElementById('videoPlayer');
const buyPremiumBtn = document.getElementById('buyPremiumBtn');
const viewSecretGalleryBtn = document.getElementById('viewSecretGalleryBtn');

// 녹화 시작
startRecordBtn.addEventListener('click', async () => {
    const stream = await navigator.mediaDevices.getUserMedia({ video: true });
    mediaRecorder = new MediaRecorder(stream);
    
    mediaRecorder.ondataavailable = event => {
        recordedChunks.push(event.data);
    };

    mediaRecorder.onstop = () => {
        const blob = new Blob(recordedChunks, { type: 'video/webm' });
        const videoURL = URL.createObjectURL(blob);
        videoPlayer.src = videoURL;
        recordedChunks = [];  // 녹화된 데이터를 초기화
    };

    mediaRecorder.start();
    startRecordBtn.disabled = true;
    stopRecordBtn.disabled = false;
    isRecording = true;
});

// 녹화 종료
stopRecordBtn.addEventListener('click', () => {
    mediaRecorder.stop();
    startRecordBtn.disabled = false;
    stopRecordBtn.disabled = true;
    isRecording = false;
});

// 유료 서비스 구매
buyPremiumBtn.addEventListener('click', () => {
    alert('유료 서비스가 활성화되었습니다.');
    // 여기에 유료 서비스 로직 추가
});

// 비밀 갤러리 열기
viewSecretGalleryBtn.addEventListener('click', () => {
    alert('비밀 갤러리를 열었습니다.');
    // 여기에 암호화된 동영상 표시 로직 추가
});
